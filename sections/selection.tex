\section{Particle Identification and Event Selection}\label{protonid}
%The next line produces an indented paragraph to start the document
 %unit.  The LaTeX defaults start most units without indentations.
\hspace{\parindent}
This section describes the process for selecting events in data and simulation
that we use to determine the strange axial form factor. First, proton tracks
are identified using a gradient-boosted decision tree model based on
reconstructed tracks features. Next, events are selected as neutral current
elastic proton events using a logistic regression model based on reconstructed
properties of the whole event include optical information. Comparisons of the
selected NC elastic proton events in the neutrino beam data are compared to the
expectation from neutrino simulation and off-beam data are shown, and each of
the remaining backgrounds is described in detail.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Particle Identification and Event Selection
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Particle Identification}
  After the particle tracks are reconstructed, we use a predictive model to
  classify proton tracks. The inputs to the model are the reconstructed
  physical variables, and the output is the probability that the track is from
  a proton vs. some other particle. There are many predictive models that we
  can use, each with advantages and disadvantages. We chose gradient-boosted
  decision trees for a few main reasons: they are easily interpretable, the
  inputs can be a mix of numeric and categorical variables, and boosted
  decision trees perform well at identifying a small signal in a large
  background.  Each tree is essentially a series of cuts based on physical
  variables which have been fine-tuned to increase the efficiency and purity of
  the final selected sample.
  \subsubsection{Reconstructed track features}\label{sec:features}
    The reconstructed features that are used as input to the classifier are
    listed below. Most of the features come directly from the track object, but
    some are created for this classifier. Each of the features used to identify
    protons either helps to separate neutrino-induced tracks from
    cosmic-induced tracks or to separate neutrino-induced proton tracks from
    other neutrino-induced particle types. For colorimetric information we only
    use information from the collection plane.

    Below is a list and description of the features designed to separate
    neutrino-induced protons from other neutrino-induced particle types.
    \begin{itemize}
      \item \textbf{Number of hits:} This is the total number of hits on the
      collection plane that are associated with track. When used in combination
      with track length and average energy deposited, this feature can be used
      to determine the hit and energy density of the track.
      \item \textbf{Straightness:} This is the ratio of distance between
      reconstructed end points (displacement) to reconstructed path length. It
      represents the amount of scattering a track undergoes. The value is
      always between zero and one with one being perfectly straight.
      \item \textbf{Cosmic score:} This is the geometry tagging cosmic score
      from Sec.~\ref{sec:tpcreco}. Tracks with a cosmic score of 1 have already
      been removed in the cosmic hit removal stage. So, this value is either 0
      (fully contained within the TPC) or 0.5 (entering or exiting the TPC).
      \item \textbf{Length:} This is the reconstructed 3D track length found by
      stepping along the trajectory points.
      \item \textbf{Start dE/dx:} This is the total energy deposited on the
      collection plane in the first six non-zero hits along the track divided
      by the distance between hits to account for the angle with respect to the
      wire plane.
      \item \textbf{End to start dE/dx ratio:} This is the ratio of the total
      $dE/dx$ from the last six non-zero hits along the track on the collection
      plane to the total $dE/dx$ from the first six non-zero hits along the
      track on the collection plane.
      \item \textbf{Truncated total dE/dx:} This is the sum of the $dE/dx$ of a
      truncated set of hits on the collection plane associated with track. The
      truncated set includes all hits along the track with a $dE/dx$ value
      within one standard deviation of the median $dE/dx$ value of all hits
      along the track on the collection plane.
      \item \textbf{Truncated average dE/dx:} This is the truncated total
      $dE/dx$ divided by the number of hits in the truncated hit set associated
      with track.
    \end{itemize}

    Next is the list and description of the features designed to separate
    neutrino-induced tracks from cosmic-induced tracks.
    \begin{itemize}
      \item \textbf{Start and end positions:} These are the reconstructed x, y,
      and z positions of start and end of the track. Tracks that start closer
      to a TPC boundary are more likely to be cosmic-induced.
      \item \textbf{$\theta$ and $\phi$:} These are the reconstructed polar and
      azimuthal angles with respect to the beam direction. Vertical tracks are
      much more likely to be cosmic-induced, while forward-going tracks are
      more likely to be from the neutrino beam.
    \end{itemize}
   
    Determining which end of a track is the beginning is difficult when a
    vertex is not observable. Since we are particularly interested in
    neutral-current elastic events with only a single proton, the direction of
    the track is a concern. A proton will deposit much more energy at the end
    of its track than at the beginning which can be used to determine the true
    direction. Since this correction is not currently implemented within the
    reconstruction, we take all reconstructed tracks that have a higher
    deposited energy at the beginning of the track than at the end of the track
    and flip them. The deposited energy at the beginning (ending) of the track
    is defined as the total $dE/dx$ of the first (last) six non-zero hits along
    the track on the collection plane.  This includes changing the saved start
    positions, end positions, $\theta$, $\phi$, start $dE/dx$, end $dE/dx$, and
    the end to start $dE/dx$ ratio.
    
  \subsubsection{Boosted decision trees}\label{sec:decisiontrees}
    A decision tree can be thought of as a series of if/else statements that
    separate a data set into two or more classes as illustrated in
    Fig.~\ref{fig:dtree}. At each node of the tree, a split is chosen to
    maximize information gain until a set level of separation is reached.  At
    the terminus of the series of splits, called a leaf, a class is assigned.
    The usual parameters that can be set when creating a decision tree are: the
    maximum depth of the tree (how many layers of nodes you will allow), the
    minimum split size (how many data points do you require to keep splitting),
    and minimum leaf size (how small does a leaf have to be before you stop). 
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/protonid/trees_diagram.pdf}
      \caption{Graphical example of a decision tree.}
      \label{fig:dtree}
    \end{figure}
    
    A single tree can easily overfit a data set if it is at all complex, and
    its output is just a class label. Gradient-boosting addresses both of these
    issues by combining many weak classifiers into a strong one. Each weak
    classifier is built based on the error of the previous one. For a given
    training set, whenever a sample is classified incorrectly by a tree, that
    sample is given a higher importance when the next tree is being created.
    Mathematically, each tree is training on the gradient of the loss function.
    After all of the trees have been created, each tree is given a weight based
    on its ability to classify the training set, and the output of the
    gradient-boosted decision tree classifier is the probability that a sample
    is in a given class.
    
    The gradient-boosted decision tree software package we use is
    XGBoost~\cite{Chen:2016btl}. There are two types of classifiers we can use
    to separate protons from other tracks: binary and multiclass. Both
    classifiers are trained on all types of reconstructed tracks. A binary
    classifier classifies each track as either a proton or not a proton, and a
    multiclass classifier classifies a track as one of many types including a
    proton. We choose to use multiclass because the information about
    non-proton tracks is useful for selecting neutral current events. The five
    classes that we train the decision trees to classify are protons (both
    neutrino-induced and cosmic), neutrino-induced muons, neutrino-induced
    pions, neutrino-induced electrons/photons, and all non-proton cosmics.
    
  \subsubsection{Training}
    \begin{table}[ht]
      \caption{Breakdown by simulated particle type reconstructed tracks in the
        gradient-boosted decision tree training set.
      \label{tab:mctrain}}
      \begin{tabularx}{\textwidth}{ l r r r r r }
        \hline
        & Protons & Muons & Pions & EM Showers & Non-proton Cosmics \\
        \hline
        No. of tracks  & 90,922 & 57,583 & 12,848 & 473,323 & 2,586,527 \\
        Fraction of set & 0.028 & 0.018 & 0.004 & 0.147 & 0.803 \\
        Class weight  & 0.141 & 0.223 & 1.000 & 0.027 & 0.005 \\
        \hline
      \end{tabularx}
    \end{table}

    The gradient-boosted decision tree model was trained on 95,600 events with
    both simulated GENIE neutrino interactions and simulated CORSIKA cosmic
    interactions. Each track in every event was treated as a separate training
    sample. Table~\ref{tab:mctrain} shows the number of each type of track that
    was used for training. There are were a total of 3,221,203 simulated
    training tracks.

    Because the training set has unbalanced classes (there are different
    numbers of each particle type) each training sample is initially weighted
    so that the sum of weights is equal to the size of the smallest class, in
    this case pions.
    \begin{equation*}
      N_s = \sum_{i=1}^{N_{n}}w^n_i \,,
    \end{equation*}
    where $N_s$ is the number of samples in the smallest class, $N_{n}$ is the
    number samples in the $n^{th}$ class, and $w^n_i$ is the weight given to
    the $ith$ sample in that class. The same weight is used for each sample in
    a class, so the value of each positive weight is $w^n=\frac{N_s}{N_{n}}$.
    Balancing the training set prevents the classifier from only learning the
    most frequent classes. In our case, the classifier could achieve a high
    accuracy by classifying everything as a cosmic in the unbalanced set
    because over 80\% of the tracks are cosmic-induced. One of our main goals
    is to have a proton ID efficiency, and since protons only make up 3\% of
    the training set, giving them a higher weight makes it more important to
    the classifier that they are correctly classified.

    The parameters used for training were chosen to both maximize
    classification accuracy and minimize overfitting to the training set.
    Overfitting occurs when the performance on the training set is more
    accurate than the performance on an external test set. The final training
    parameter settings are:
    \begin{itemize}
      \item \textbf{Objective: multiclass: softprob} \\
      The learning objective. We want to classify five different track types
      and get a probability of each class.  
      \item \textbf{Learning rate: 0.045}  \\
      The factor each incorrectly classified sample gets re-weighted by for the
      next tree.  A smaller learning rate requires more trees but prevents
      overfitting.
      \item \textbf{Number of trees: 500} \\
      The total number of trees in classifier.
      \item \textbf{Maximum depth: 10} \\ 
      The maximum number of layers of nodes each tree can have.
      \item \textbf{Maximum sampled features: 0.8} \\
      The fraction of total features that each tree can use to train. These are
      randomly sampled.
      \item \textbf{Maximum sampled observations: 0.85} \\
      The fraction of total samples that each tree can use to train. These are
      randomly sampled.
    \end{itemize}

  \subsubsection{Performance on a Test Set}\label{sec:protonidtest}
    The performance of the gradient-boosted decision tree classifier was tested
    on a set of 3,200,000 reconstructed tracks from 96,200 events with
    simulated GENIE neutrino interactions and simulated CORSIKA cosmic
    interactions. This set of tracks was generated in the exact same way as the
    training set.

    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=5in]{figures/analysis/protonid/protonid_mc_output_norm.pdf}
      \caption{Area-normalized histograms of decision tree proton
      identification scores for simulated protons and other simulated proton
      tracks.}
      \label{fig:pidmcout}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=5in]{figures/analysis/protonid/protonid_mc_output_norm_ncelastic.pdf}
      \caption{Area-normalized histogram of decision tree proton identification
      scores for simulated proton tracks from NC elastic proton interactions.}
      \label{fig:pidmcoutNCE}
    \end{figure}
    Figure~\ref{fig:pidmcout} shows normalized histograms of the output proton
    score for every track in the test set. The proton score ranges from zero to
    one with zero being the least proton-like and one being the most. The blue
    histogram shows all simulated neutrino-induced and cosmic induced proton
    tracks normalized so that the area under the histogram is one. The orange
    histogram shows every other simulated track type, also normalized so that
    the area under it is equal to one. Figure~\ref{fig:pidmcoutNCE} shows the
    area-normalized histogram of proton scores for simulated proton tracks that
    were produced in neutral current elastic proton events.

    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=5.5in]{figures/analysis/protonid/heatmap_mcc87_pmtrack_final.pdf}
      \caption{Heatmap showing the fraction of each class that is made up of a
      given particle type.}
      \label{fig:heatmap}
    \end{figure}
    Figure~\ref{fig:heatmap} shows the overall classification performance of
    the gradient-boosted decision tree model on the test set for each class.
    The x axis shows the true particle type and the y axis shows the particle
    classes. The numbers in the boxes are the fraction of the class that is
    made up of the given true particle type. The fraction of true protons in
    the set of tracks classified as protons is 0.71, the fraction of true muons
    in that set is 0.04, the fraction of true pions is 0.09, the fraction of
    electromagnetic shower particles is 0.04, and the fraction of non-proton
    cosmics in the proton-classified set is 0.05. A track is labelled as a
    given class type in this plot if the particle's decision tree score for
    that class is higher than its score for any of the other four classes.  The
    numbers in this plot were calculated using equal numbers of each true
    particle type. In reality, there are far more non-proton cosmic tracks than
    there are true protons, and the fraction of true protons in the set
    classified as protons will be smaller.

    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/PID_efficiency_allmcke.pdf}
        \caption{The full simulated kinetic energy range.}
        \label{fig:pideffkeall}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/PID_efficiency_mcke.pdf}
        \caption{The kinetic energy range used in this analysis.}
        \label{fig:pideffkerng}
      \end{subfigure}
      \caption{The efficiency of simulated neutrino-induced proton tracks
        correctly classified as protons as a function of true proton kinetic energy.}
      \label{fig:pideffke}
    \end{figure}
    Figure~\ref{fig:pideffke} shows the efficiency of the decision tree proton
    identification on simulated neutrino-induced protons as a function of true
    proton kinetic energy. The left plot (\ref{fig:pideffkeall}) shows the full
    simulated range of true proton kinetic energy, and the right
    (\ref{fig:pideffkerng}) shows the range of interest to this analysis. In
    the interesting range of kinetic energies, the proton identification
    efficiency stays relatively flat between 0.8 and 0.8 efficiency, with an
    average efficiency of 0.71. A track is considered positively identified as
    a proton in these plots if its decision tree proton score is higher than
    0.5, meaning it is more likely than not to be a proton.

    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/PID_efficiency_mctheta_kerange.pdf}
        \caption{Efficiency as a function of the cosine of the true proton
          angle from the beam direction.}
        \label{fig:pideffangletheta}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/PID_efficiency_mcphi_kerange.pdf}
        \caption{Efficiency as a function of the true proton angle around the beam direction.}
        \label{fig:pideffanglephi}
      \end{subfigure}
      \caption{The efficiency of simulated neutrino-induced proton tracks
        correctly classified as protons as a function of true proton angle.}
      \label{fig:pideffangle}
    \end{figure}
    Figure~\ref{fig:pideffangle} shows the efficiency of the decision tree proton
    identification on simulated neutrino-induced protons as a function of true
    proton angle. The efficiencies in these plots are calculated using only the
    simulated protons within the kinetic energy range of interest ($0.05$ GeV
    $\le T_p \le 0.5$ GeV) used in Figure~\ref{fig:pideffkerng}. The left plot
    (\ref{fig:pideffangletheta}) shows the efficiency as a function of
    $\cos(\theta_p)$, where $\theta_p$ is the angle of the proton from the
    neutrino beam direction. At $\cos(theta_p) = 1$ the proton is parallel to
    the beam, at $\cos(\theta_p) = -1$ the proton is anti-parallel to the beam,
    and at $\cos(\theta_p) = 0$ the proton is perpendicular to the beam. When
    the proton is perpendicular to the beam, it is aligned with the anode
    collection plane, and will not traverse more than one collection plane
    wire. A large contribution to the decrease in efficiency at $\cos(\theta_p)
    = 0$ is the fact that the decision tree classifier only uses calorimetry
    information from the collection plane. The right
    plot(\ref{fig:pideffanglephi}) shows the efficiency as a function of
    $\phi_p$ which is the angle around the neutrino beam direction. The flat
    efficiency is due to the fact that the neutrino-induced proton angle should
    be isotropic in $\phi_p$, and the angle around the beam direction has no
    effect on the angle with respect to the angle of the anode wires. Again, a
    track is considered positively identified as a proton in these plots if its
    decision tree proton score is higher than 0.5.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=5.0in]{figures/analysis/protonid/PID_efficiency_mcthetavmcke.pdf}
      \caption{Two-dimensional efficiency for true proton $\cos(\theta_p)$
      versus true proton kinetic energy.}
      \label{fig:pideffthetake}
    \end{figure}
    Figure~\ref{fig:pideffthetake} shows the two-dimensional efficiency for
    true proton $\cos(\theta_p)$ versus true proton kinetic energy. The kinetic
    energy range of interest to this analysis goes up to $0.5$ GeV (the bottom
    half of the plot).

  \subsubsection{Performance on a Neutrino Data Subset}\label{sec:datamcpid}
    The gradient-boosted decision tree classifier was tested on a subset of
    MicroBooNE neutrino data corresponding to 5e19 POT ($< 5\%$ of the fill
    MicroBooNE approved POT). The data set is taken entirely from MicroBooNE's
    first year of running (Run I). The results of the classifier on the
    neutrino data subset was compared to the results on a combination of
    neutrino and cosmic simulation and off-beam data. Each of the samples is
    scaled to 5e19 POT. The samples used in these comparisons and the scaling
    factors are listed below. 
    \begin{enumerate}
      \item Run I 5e19 POT neutrino data subset
      \begin{itemize}
        \item Number of events: 171,603
        \item POT (\texttt{tor860\_wcut}): $4.41e19$
        \item Number of triggers (\texttt{E1DCNT\_wcut}): 9,779,224
        \item Normalization factor: 1
      \end{itemize}
      \item Run I off-beam data subset
      \begin{itemize}
        \item Number of events: 189,226
        \item Number of triggers (\texttt{EXT}): 14,579,406
        \item Normalization factor: 0.7063
      \end{itemize}
      \item Neutrino Monte Carlo with cosmic data overlay set
      \begin{itemize}
        \item Number of events: 200,160
        \item POT: $2.08e20$
        \item Flux correction factor: 1.029
        \item Normalization factor: 0.2429
      \end{itemize}
    \item Neutrino dirt Monte Carlo with simulated cosmic data set
      \begin{itemize}
        \item Number of events: 105214
        \item POT: $4.66e20$
        \item POT normalization factor: 0.0947
        \item Data driven normalization factor: 0.5 (described in Sec.~\ref{sec:dirt})
        \item Normalization factor: 0.0474
      \end{itemize}
    \end{enumerate}
    The number of triggers listed is the total number of beam spill triggers
    issued by the accelerator division and does not include the optical
    software trigger implemented in MicroBooNE.  This is how we scale the
    off-beam data to the neutrino beam data. The number of events is the number
    of events left after the optical pre-selection described in
    section~\ref{sec:optpresel}. The off-beam data is a direct measurement of
    the background to the neutrino beam data that is due to a cosmic
    interaction occurring in-time with the beam. The neutrino Monte Carlo
    simulates neutrino beam interactions that occur within the liquid argon
    cryostat, and the neutrino dirt Monte Carlo simulates the background
    neutrino beam interactions that occur outside of the cryostat.
    
    Figure~\ref{fig:pidscores} shows the comparison of the decision tree proton
    score between the subset of MicroBooNE neutrino data and the MicroBooNE
    simulation. The top left plot is in linear scale and the top right plot is
    in log scale. The bottom plots are the same, and they show the ratio
    between the on-beam neutrino data and the combination of neutrino
    simulation and off-beam data.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/datamcpid/pscore_overlay.pdf}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/datamcpid/pscore_overlay-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/datamcpid/pscore_overlay_log.pdf}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/protonid/datamcpid/pscore_overlay-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Comparison of the decision tree proton scores between a subset
      of MicroBooNE neutrino data and a combination of MicroBooNE neutrino
      simulation and off-beam data.}
      \label{fig:pidscores}
    \end{figure}

    In all of the figures in this section, the black points in the top plots
    show the subset of neutrino data.  The horizontal bars represent the bin
    width, and the vertical bars represent the statistical uncertainty. The
    light gray filled histogram includes tracks from the off-beam data. These
    tracks represent the background of events where a cosmic interaction in the
    detector coincident with the beam time window triggered the event, and
    there was no actual neutrino interaction. The dark gray filled histograms
    include cosmic tracks that are in the background of events with actual
    neutrino interactions that triggered the event. For simulated neutrino
    interactions inside the detector, real data cosmic tracks are overlaid on
    the simulated event, and for simulated neutrino interaction outside the
    detector, the background cosmic tracks are from simulation. The color
    filled histograms include tracks from simulated neutrino interactions. The
    peach colored histograms include simulated neutrino-induced proton tracks,
    the dark green includes simulated neutrino-induced pion tracks, the light
    green includes simulated neutrino-induced muon tracks, and the purple
    includes simulated neutrino-induced electromagnetic shower tracks. The
    fraction of proton tracks in the right plots (the tracks classified as
    protons) is much larger than in the left plots (all tracks), which is the
    goal of the classifier.  The bottom plots in all of the figures show the
    ratio of the neutrino data points to the sum of all of the stacked, filled
    histograms. A ratio of one means perfect data to simulation agreement.

    Figures~\ref{fig:pidnhits}-\ref{fig:pidphi} show comparisons between the
    subset of MicroBooNE neutrino data and the MicroBooNE simulation for each
    of the input variables being used in the decision tree classifier. A
    description of each of these reconstructed track features is given in
    Sec.~\ref{sec:features}. The left plots show the histogram of the given
    variable for all tracks being input to the classifier, and the right plots
    show the histograms of the given variable for the tracks that were
    classified as protons. A track is considered classified as a proton if the
    decision tree proton score is greater than 0.5 for that track.
    
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_nhits_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_nhits_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_nhits_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_nhits_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the number of hits on the collection
      plane.}
      \label{fig:pidnhits}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_distlenratio_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_distlenratio_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_distlenratio_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_distlenratio_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track straightness.}
      \label{fig:piddistlenratio}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_length_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_length_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_length_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_length_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track length.}
      \label{fig:pidlength}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startdedx_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startdedx_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startdedx_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startdedx_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track start $dE/dx$.}
      \label{fig:piddedx}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_dedxratio_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_dedxratio_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_dedxratio_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_dedxratio_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the end to start $dE/dx$ ratio.}
      \label{fig:piddedxratio}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_trtotaldedx_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_trtotaldedx_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_trtotaldedx_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_trtotaldedx_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track truncated total $dE/dx$.}
      \label{fig:pidtrtotaldedx}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_traveragededx_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_traveragededx_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_traveragededx_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_traveragededx_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the truncated average $dE/dx$.}
      \label{fig:pidtraveragededx}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_starty_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_starty_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_starty_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_starty_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track starting $y$ position.}
      \label{fig:pidstarty}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endy_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endy_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endy_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endy_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track ending $y$ position.}
      \label{fig:pidendy}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startz_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startz_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startz_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_startz_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track starting $z$ position.}
      \label{fig:pidstartz}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endz_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endz_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endz_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_endz_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track ending $z$ position.}
      \label{fig:pidendz}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_costheta_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_costheta_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_costheta_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_costheta_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track $\cos(\theta)$ angle.}
      \label{fig:pidcostheta}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_phi_all_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_phi_all_truncated-ratio.pdf}
        \caption{All reconstructed tracks.}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_phi_pass_truncated.pdf}
        \includegraphics[angle=0,width=2.5in]{figures/analysis/protonid/datamcpid/pid_phi_pass_truncated-ratio.pdf}
        \caption{All reconstructed tracks that are classified as protons.}
      \end{subfigure}
      \caption{Breakdown of the different particle track types in neutrino data
      and simulation as a function of the track $\phi$ angle.}
      \label{fig:pidphi}
    \end{figure}

    \FloatBarrier


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Neutral Current Elastic Proton Event Selection
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Event Selection}\label{sec:selection}
  The neutral current elastic proton event selection consists of some simple
  pre-selection cuts to remove events that are very unlike the signal and a
  final event selection using a logistic regression model based on event
  details. The proton identification in the previous section was designed to
  identify any proton induced track from any type of event. To select protons
  from NC elastic neutrino-proton interactions, we use optical timing and
  position information, information about activity surrounding the proton
  candidate, and information about unrelated tracks in the event that may be
  neutrino induced.

  \subsubsection{Optical Pre-selection}\label{sec:optpresel}
    A common optical pre-filter is run over MicroBooNE data before any of the
    events are reconstructed. The common optical filter requires both that
    there is a sufficient optical flash within the 2~$\mu s$ beam time window
    and that there is no such flash in a 2~$\mu s$ time window immediately
    preceding the beam. This 2~$\mu s$ window before the beam is called the
    veto window.

    First, each of the 2~$\mu s$ windows is sliced into 339 bins that are
    94~ns wide. Then the total number of PE of any optical pulses that
    occur within a given bin are added to that time bin. If any of the time
    bins within the larger 2~$\mu s$ window add to more than 20 PE, it is
    considered a sufficient flash to the optical filter. If any one of these
    flashes occur within the beam window and none of the flashes occur within
    the veto window the event is accepted. Otherwise, it is rejected.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/optfilter_efficiency.pdf}
      \caption{Efficiency of optical pre-selection on simulated NC elastic
        proton events.}
      \label{fig:opfiltereff}
    \end{figure}

    Figure~\ref{fig:opfiltereff} shows the efficiency of the optical
    pre-selection on simulated NC elastic proton events as a function of true
    negative four-momentum squared. The overall efficiency in range between
    $Q^2 = 0.1$~GeV$^2$ and $Q^2 = 1.0$~GeV$^2$ is 81\%.

  \subsubsection{NC Elastic Pre-selection}
    Before making a final neutral current elastic event selection, some simple
    cuts are made to reject a large number of background events that are very
    unlikely to be NC elastic interactions. The result of each of these
    pre-cuts on the scaled data and simulation samples described in
    Sec.~\ref{sec:datamcpid} are shown in Tab.~\ref{tab:preseldatamc}. 
    \begin{table}
      \caption{Number of remaining events in 5e19 POT data set after each of
        the NC elastic pre-selection cuts.
      \label{tab:preseldatamc}}
      \begin{tabularx}{\textwidth}{l r r | r r}
        \hline
        Cut & Simulation & Off-Beam Data & Sim.+Off-Beam & Neutrino Data \\
        \hline
        Beam Flash & 33743 & 71208 & 104951 & 108064 \\
        Containment & 33742 & 71207 & 104949 & 108058 \\
        Length & 33523 & 70426 & 103949 & 107123 \\
        Proton Score & 16805 & 23491 & 40296 & 41867 \\
        \hline
      \end{tabularx}
    \end{table}
    The first column shows the total number of simulated neutrino events that
    pass each cut scaled to 5e19 POT, and the second column shows the total
    number of off-beam data events that pass each cut scaled to 5e19 POT. The
    third column is the sum of the first two columns which is the expected
    number of on-beam events in 5e19 POT. The last column shows the total
    number of on-beam events in the 5e19 POT data after each cut. If the
    simulation were a perfect representation of reality, the last two columns
    would be the same. At each cut in the pre-selection the measured number of
    event in the on-beam neutrino data is within 5\% of the expected number of
    events from simulation and off-beam data.

    The first pre-selection requirement is that there is at least one
    reconstructed optical flash inside the 1.6~$\mu s$ neutrino beam time
    window. This cut is to reduce the amount of cosmic background. The next two
    pre-selection requirements are that there is at least one reconstructed
    track fuller contained within a fiducial TPC volume that is at least 2.5~cm
    long. The fiducial volume is defined as being at least 10~cm away from
    either $y$ boundary of the TPC active volume and at least 5~cm away from
    any of the $x$ and $z$ boundaries of the TPC active volume. The containment
    and length requirement don't reduce the number of events by a lot, but they
    reduce the number of tracks within each event that are considered when
    trying to select NC elastic proton tracks. The last pre-selection
    requirement is that there is at least one track in the event that has a
    proton score from the gradient-boosted decision tree classifier greater
    than 0.5. To summarize all of the cuts, the set of events after the
    pre-selection had an interaction in-time with the neutrino beam and at
    least one track that is likely to be a proton contained in the TPC fiducial
    volume.  The efficiency and purity of simulated NC elastic proton events
    after each of the cuts is shown in Tab.~\ref{tab:preseleff}.
    \begin{table}
      \caption{Efficiency and purity of simulated NC elastic proton events
        after each of the NC elastic pre-selection cuts.
      \label{tab:preseleff}}
      \begin{tabularx}{\textwidth}{l r r r}
        \hline
        Cut & Efficiency & Relative Efficiency & Purity \\
        \hline
        Optical Pre-Filter & 0.81 & 0.81 & 0.004 \\
        Beam Flash & 0.78 & 0.97 & 0.005 \\
        Reconstruction & 0.62 & 0.79 & 0.005 \\
        Containment & 0.53 & 0.86 & 0.005 \\
        Length & 0.46 & 0.87 & 0.005 \\
        Proton Score & 0.39 & 0.84 & 0.009 \\
        \hline
      \end{tabularx}
    \end{table}
    Figure~\ref{fig:preseleff} shows the efficiency of the pre-selection on
    simulated neutrino events as a function of true negative four-momentum
    squared.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/presel_efficiency.pdf}
      \caption{Efficiency of simulated NC elastic proton events as a function
        of true $Q^2$ after the pre-selection cuts.}
      \label{fig:preseleff}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/presel_length.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/presel_length_ratio.pdf}
      \caption{Reconstructed track length of the longest proton candidate track
      in the events after all pre-selection cuts.}
      \label{fig:presellength}
    \end{figure}

    Figure~\ref{fig:presellength} shows the reconstructed track lengths of the
    longest remaining proton candidate track in the events remaining after the
    preselection. The black points in the top plot include the events in the
    5e19 POT neutrino data set with statistical uncertainty only. The gray
    filled histogram include the off-beam data events scaled to 5e19 POT, and
    the color filled histograms include the simulated neutrino events scaled to
    5e19 POT. The simulated NC elastic proton events in the TPC are in peach,
    the simulated charged current events in the TPC are in blue, the simulated
    neutral current background TPC events are in purple, the simulated events
    in which the neutrino interaction occurred in the liquid argon but outside
    of the TPC are in green, and the simulated events in which the neutrino
    interaction occurred outside of the liquid argon cryostat are in yellow.
    Each of the remaining background type is described in more detail in
    section~\ref{sec:effbg}.

  \subsubsection{Selection Variables}\label{sec:selectionvars}
    To select NC elastic proton interactions we look for events with a track
    that is very likely to be a proton, the track is near the reconstructed
    beam flash, there are no other tracks near the proton candidate track,
    there are no tracks likely to be from charged current interactions near the
    reconstructed beam flash, and the proton candidate track is often in the
    direction of the neutrino beam. The following seven variables are used to
    select these events,
    \begin{enumerate}
      \item the decision tree proton ID score,
      \item the shortest distance between either reconstructed endpoint of the
      candidate track and the next closest endpoint of a different
      reconstructed track,
      \item the distance from the center of the reconstructed track to the
      center of the reconstructed beam flash in the $z$ direction,
      \item the distance from the center of the reconstructed track to the
      center of the reconstructed beam flash in the $y$ direction,
      \item whether or not the reconstructed track is in the neutrino beam
      direction,
      \item the distance between any reconstructed tracks with a decision tree
      muon ID score greater than 0.5 and the reconstructed beam flash in the
      $z$ direction,
      \item the distance between any reconstructed tracks with a decision tree
      pion ID score greater than 0.5 and the reconstructed beam flash in the
      $z$ direction.
    \end{enumerate}
    The center of the reconstructed track is defined as the halfway point
    between the reconstructed track endpoints in the dimension of interest. The
    center of the reconstructed flash is the PE-weighted reconstructed center
    of the flash. The beam flash is defined as a flash whose peak amplitude
    occurs within the neutrino beam time window. A track is defined as in the
    beam direction if its reconstructed endpoint is downstream (higher in $z$)
    than its reconstructed start point. If there are no tracks in the event
    identified as a muon (in item 6.) or a pion (in item 7.), the value is set
    to 999~cm, which is close to the maximum distance a track can be from a
    flash in the TPC. A comparison of each of these variables between data and
    simulation after the pre-selection is shown in
    Figs.~\ref{fig:lrpid}-\ref{fig:lrpidist}.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_pscore.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_pscore-ratio.pdf}
      \caption{Decision tree proton score after the pre-selection cuts.}
      \label{fig:lrpid}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_vtxdist.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_vtxdist-ratio.pdf}
      \caption{Distance to the next closest track after the pre-selection cuts.}
      \label{fig:lrvtxdist}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_fzdist.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_fzdist-ratio.pdf}
      \caption{Distance to the beam flash in $z$ after the
        pre-selection cuts.}
      \label{fig:lrfzdist}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_fydist.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_fydist-ratio.pdf}
      \caption{Distance to the beam flash in $y$ after the
        pre-selection cuts.}
      \label{fig:lrfydist}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_forward.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_forward-ratio.pdf}
      \caption{Whether or not the track is forward going after the pre-selection
        cuts.}
      \label{fig:lrforward}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_mudist.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_mudist-ratio.pdf}
      \caption{Distance between muon track and flash after the pre-selection
        cuts.}
      \label{fig:lrmudist}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_pidist.pdf} \\
      \includegraphics[angle=0,width=4in]{figures/analysis/selection/LR_input_all_pidist-ratio.pdf}
      \caption{Distance between pion track and flash after the pre-selection
        cuts.}
      \label{fig:lrpidist}
    \end{figure}

    \FloatBarrier

  \subsubsection{Logistic Regression}
    To determine which events are NC elastic like based on these seven
    variables, we use them as input to a logistic regression
    model~\cite{Hosmer2005}. The difference between a logistic regression model
    and a linear regression model is that the outcome is binary (or logistic).
    Otherwise, the methods used to fit logistic and linear regression models
    follow the same principles. In our logistic regression a multi-dimensional
    sigmoid function is fit to the signal and background data. The output is a
    score that can be used to determine how signal-like a data point is.
    \begin{equation*}
      S(g({\bf x})) = \frac{e^{g({\bf x})}}{1 + e^{g({\bf x})}} \,,
    \end{equation*}
    where $g({\bf x})$ is a linear combination of the selection variables, ${\bf x}$,
    \begin{equation*}
      g({\bf x}) = w_0 + w_1 x_1 + w_2 x_2 + ... + w_7 x_7 \,.
    \end{equation*}
    Here $x_1$ is item 1 from the list in Sec.~\ref{sec:selectionvars} (the
    proton ID score), $x_2$ is item 2 (the distance to the next closest track),
    etc. The set of weights, $w_0,...,w_7$ are determined from a fit to the
    data. We determined these weights using the StatsModels
    module~\cite{pystats} in Python to fit the model to a subset of the
    simulated neutrino events described in Sec.~\ref{sec:protonidtest} along
    with a set of simulated cosmic events that produce an optical flash in-time
    with the neutrino beam. The simulated set of in-time cosmics should match
    the off-beam data in a perfect simulation. For the fit, 998 simulated NC
    elastic proton events, 2000 simulated background neutrino events, and 1806
    simulated background in-time cosmic events were used. The final set of
    weights used are
    \begin{equation}
      \begin{aligned}
        w_0 = -5.943956,& \\
        w_1 =  5.388985,& \\
        w_2 =  0.021189,& \\
        w_3 = -0.016710,& \\
        w_4 = -0.017510,& \\
        w_5 =  0.592240,& \\
        w_6 =  0.001084,& \\
        w_7 =  0.000989.&
      \end{aligned}
    \end{equation}
    The $\chi^2/DoF$ of the fit was $8161/4804 = 1.70$. The degrees of freedom
    in the fit are the 4804 simulated events used.
    
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/LR_output_overlay_stacked.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/LR_output_overlay-ratio.pdf}
      \caption{Logistic regression NC elastic events selection score.}
      \label{fig:lroutput}
    \end{figure}
    Figure~\ref{fig:lroutput} shows the output logistic regression score on the
    simulated neutrino events plus the off-beam data compared to the output on
    the 5e19 POT neutrino beam data. Again, the black points in the top plot
    include the 5e19 POT subset of neutrino data with statistical uncertainty
    only, the gray filled histogram includes off-beam data scaled to 5e19 POT,
    and the color filled histograms include the simulated neutrino interactions
    overlaid with cosmic data backgrounds scaled to 5e19 POT. The peach color
    is NC elastic proton events in the TPC, blue is charged current background
    events in the TPC, purple is neutral current background events in the TPC,
    green is background from neutrino interactions in the liquid argon outside
    of the TPC, and yellow is background from neutrino interactions outside of
    the liquid argon cryostat. The higher the logistic regression score, the
    more likely the event is NC elastic proton. The bottom plot shows the ratio
    of the 5e19 POT neutrino beam data to the sum of the simulated neutrino
    events and off-beam data.
    
    Figure~\ref{fig:lreffpur} shows the efficiency and purity of the NC elastic
    signal for cutting on given logistic regression scores.
    Figure~\ref{fig:lreffnpur} shows both the efficiency curve and the purity
    curve of the NC elastic event selection on the simulated neutrino events
    and off-beam data as a function of the logistic regression score cut. This
    cut is imposed after the pre-selection cuts, which is why the efficiency
    only goes as high as 0.41. Figure~\ref{fig:lreffvpur} shows the purity on
    the $y$-axis as a function of efficiency on the $x$-axis for different
    logistic regression score cuts. Some score cut values are labelled along
    the curve.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/selection/LR_effandpur.pdf}\hspace{2pc}%
        \caption{Efficiency and purity curves overlaid.}
        \label{fig:lreffnpur}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/selection/LR_effvpur.pdf}\hspace{2pc}%
        \caption{Purity as a function of efficiency.}
        \label{fig:lreffvpur}
      \end{subfigure}
      \caption{Efficiency and purity of the NC elastic proton event selection
      given several different cut values on the logistic regression score.
      \label{fig:lreffpur}}
    \end{figure}
   
    In this analysis we choose a logistic regression score cut of 0.9 to
    minimize the backgrounds as much as reasonably possible. The gives us an
    overall NC elastic proton events selection efficiency of 0.11 and a purity
    of 0.30 based on simulated neutrino events and off-beam data. The
    efficiency of this selection on simulated NC elastic proton events is shown
    in Fig.~\ref{fig:nceeff} as a function of true $Q^2$. The overall shape of
    the NC elastic proton selection efficiency remains relatively flat across
    the $Q^2$ range of interest.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncsel_efficiency.pdf}
      \caption{Efficiency of the NC elastic proton event selection on simulated
      NC elastic proton events.}
      \label{fig:nceeff}
    \end{figure}

  \subsubsection{Comparison of Event Selection on Neutrino Beam Data to
  Expectation from Simulation and Off-Beam Data}\label{sec:datamcevent}
    Figures~\ref{fig:ncetheta}-{fig:ncestartz} show comparisons between the
    final selected events in the neutrino beam data and the neutrino simulation
    and off-beam data. The full Run I and simulated data sets are used in these
    comparisons. Each of the data sets is scaled to the size of the Run I data
    (1.7e20 POT). The data sets and the scaling factors are listed below.
    \begin{enumerate}
      \item Run I 1.7e19 POT neutrino data set
      \begin{itemize}
        \item Number of events: 
        \item POT (\texttt{tor860\_wcut}): 
        \item Number of triggers (\texttt{E1DCNT\_wcut}):
        \item Normalization factor: 1
      \end{itemize}
      \item Run I off-beam data subset
      \begin{itemize}
        \item Number of events: 941,584
        \item Number of triggers (\texttt{EXT}): 73,761,274
        \item Normalization factor: 
      \end{itemize}
      \item Neutrino Monte Carlo with cosmic data overlay set
      \begin{itemize}
        \item Number of events: 750,629
        \item POT: 
        \item Flux correction factor: 1.029
        \item Normalization factor: 
      \end{itemize}
    \item Neutrino dirt Monte Carlo with simulated cosmic data set
      \begin{itemize}
        \item Number of events: 105214
        \item POT: $4.66e20$
        \item POT normalization factor: 0.0947
        \item Data driven normalization factor: 0.5 (described in Sec.~\ref{sec:dirt})
        \item Normalization factor: 0.0474
      \end{itemize}
    \end{enumerate}

    Figure~\ref{fig:nceq2} shows the comparison between neutrino beam data and
    the expectation from simulation and off-beam data as a function of
    reconstructed negative four-momentum transfer squared, which is calculated
    from the proton kinetic energy, $T_p$, as derived in
    Sec.~\ref{sec:neutrinos},
    \begin{equation*}
      Q_p^2 = 2 T_p M_p,
    \end{equation*}
    where $M_p$ is the proton mass.  This is the comparison that will be used
    to extract the strange axial form factor parameters (described in
    Sec.~\ref{sec:analysis}). In this and all of the following figures in this
    section, the black points in the top plot include the neutrino beam data
    with statistical uncertainty only, the gray filled histogram includes
    off-beam data, and the color filled histograms include simulated neutrino
    events with overlaid cosmic data backgrounds. The peach are NC elastic
    proton events, the blue are CC background events in the TPC, the purple are
    NC background events in the TPC, the green are background events from
    neutrino interactions in the liquid argon outside of the TPC, and the
    yellow are backgrounds from neutrino interactions outside of the liquid
    argon cryostat. Each of these backgrounds are described in more detail in
    Sec.~\ref{sec:effbg}. The bottom plot shows the ratio of the selected
    neutrino beam data events to the combination of selected simulated neutrino
    events and selected off-beam data events. If the simulation and data were
    exactly the same, the ratio would be equal to one.
    
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_q2.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_q2-ratio.pdf} \\
      \caption{Selected NC elastic proton events as a function of reconstructed $Q_p^2$.}
      \label{fig:nceq2}
    \end{figure}

    Figures~\ref{fig:ncetheta}~and~\ref{fig:ncephi} show the comparison between
    neutrino beam data and the expectation from neutrino simulation and
    off-beam data as a function of the reconstructed proton angle.
    Figure~\ref{fig:ncetheta} shows this as a function of the cosine of the
    proton angle from the beam direction, $\cos(\theta_p)$, and
    Fig.~\ref{fig:ncephi} shows it as a function of the proton angle around the
    beam direction, $\phi_p$. The $\cos(\theta_p)$ distribution appears to have
    a peak near 0.4 and another peak near 1.0. These peaks in the off-beam data
    are a combination of angle dependence of the cosmic ray flux and the
    reconstruction efficiency of the MicroBooNE TPC. The simulated
    neutrino-induced tracks tend to be more in the direction of the neutrino
    beam. The $\phi_p$ distribution has clear peaks in the off-beam data at
    $\phi_p = \pm \pi/2$. The $-\pi/2$ peak corresponds to tracks that are
    reconstructed as vertically down-going in the TPC and the $+\pi/2$ peak
    corresponds to tracks that are reconstructed as vertically up-going. Both
    peaks are due to down-going cosmic tracks, but some of these tracks are
    mis-reconstructed as going up through the detector. The simulated
    neutrino-induced tracks are relatively isotropic in $\phi$.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_theta.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_theta-ratio.pdf} \\
      \caption{Selected NC elastic proton events as a function of reconstructed $\cos(\theta_p)$.}
      \label{fig:ncetheta}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_phi.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_phi-ratio.pdf} \\
      \caption{Selected NC elastic proton events as a function of reconstructed $\phi_p$.}
      \label{fig:ncephi}
    \end{figure}

    Figures~\ref{fig:ncestartx},~\ref{fig:ncestarty}~and~\ref{fig:ncestartz}
    show the comparison between neutrino beam data and the expectation from
    neutrino simulation and off-beam data as a function of the start points of
    the reconstructed tracks in $x$, $y$, and $z$, respectively. In the
    reference frame used by MicroBooNE, the $x$ dimension is the dimension
    across the width of the detector with the anode near $x = 0$~cm and the
    cathode near $x = 250$~cm, the $y$ dimension is the vertical dimension
    across the height of the detector with the bottom of the TPC near $y =
    -100$~cm and the top near y = $+100$~cm, and the $z$ dimension is the
    dimension in the beam direction across the length of the detector with the
    upstream (front) end of the detector near $z = 0$~cm and the downstream
    (back) end of the detector near $z = 1000$~cm.
    
    In Fig.~\ref{fig:ncestartx}, the higher number of selected events at low
    $x$ is due to the greater charge and light collection efficiency for
    particles that are near the anode since both the TPC readout wires and the
    PMTs are on the anode side of the detector at $x = 0$.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_startx.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_startx-ratio.pdf} \\
      \caption{Selected NC elastic proton events as a function of reconstructed $x$ position.}
      \label{fig:ncestartx}
    \end{figure}

    In Fig~\ref{fig:ncestarty}, the increase in the number of selected off-beam
    tracks from the bottom ($y = -100$~cm) to the top ($y = +100$~cm) of the
    TPC is due to the fact that cosmic tracks enter through the top of the
    detector, and not all tracks make it all of the way through. The greater
    number of selected simulated neutrino events near the center of the
    detector ($y = 0$) might be due to the fact that tracks at an angle are
    more likely to fail the fiducial TPC containment cut when they are closer
    to the edges of the detector. This may be more visible in the $y$ dimension
    than the $x$ because there are no other competing effects.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_starty.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_starty-ratio.pdf} \\
      \caption{Selected NC elastic proton events as a function of reconstructed $y$ position.}
      \label{fig:ncestarty}
    \end{figure}

    In Fig.~\ref{fig:ncestartz}, the selected off-beam and the selected
    neutrino events are fairly uniform in the $z$ dimension. The small decrease
    in selected events near the very back of the TPC ($z \approx 1000$~cm) is
    due to the fact that tracks are much less likely to be contained in the TPC
    if they are produced so close to the back edge.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_startz.pdf} \\
      \includegraphics[angle=0,width=4.5in]{figures/analysis/selection/ncselection_bacgkrounds_startz-ratio.pdf} \\
      \caption{Selected NC elastic proton events as a function of reconstructed $z$ position.}
      \label{fig:ncestartz}
    \end{figure}

    \FloatBarrier

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Background Estimation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Remaining Backgrounds}\label{sec:effbg}
  The remaining backgrounds after the final neutral current elastic
  neutrino-proton event selection include events in which a neutrino
  interaction occurred outside of the liquid argon cryostat, events in which a
  neutrino interaction occurred in the liquid argon but outside of the active
  TPC volume, events in which a neutrino interaction that was not an NC elastic
  neutrino-proton interaction occurred within the active volume, and events in
  which a cosmic interaction occurred at the same time as the neutrino beam
  spill, and there was no neutrino interaction. In all of these cases except
  the last one, tracks from the neutrino interaction produced scintillation
  light within the cryostat that triggered the event readout, but it could have
  been either a track from the neutrino event or cosmic-induced track that was
  tagged as the proton candidate.

  \subsubsection{Beam Induced Dirt Background}\label{sec:dirt}
    The dirt background, described in Sec.~\ref{sec:beam}, consists of any
    selected events that are due to a neutrino interaction outside of the
    liquid argon cryostat. The majority of this background is caused by
    neutrons entering the detector and scattering protons. Sometimes the
    neutron is directly from the neutrino interaction in the dirt, and other
    times secondary particles from the neutrino interaction enter the cryostat
    and cause a flash, but an unrelated proton from a cosmic neutron happens to
    be spatially nearby. Figure~\ref{fig:selecteddirt} shows the total dirt
    background that passes the NC elastic proton event selection as a function
    of reconstructed $Q^2$. The filled yellow histogram includes all remaining
    dirt events, and the pale yellow box shows the statistical uncertainty on
    the number of events. An overall data-driven normalization has been applied
    and is described below. The hatched histograms overlaying the yellow filled
    histogram show what type of particle was selected as the NC elastic proton
    candidate. The blue hatched histograms include the events in which a proton
    was selected with hatching diagonal for cosmic protons and vertical
    hatching for neutrino beam induced protons. The red hatched histograms
    include the events in which a track from an electromagnetic shower was
    selected with diagonal hatching for cosmic showers and vertical hatching
    for neutrino beam induced showers. The purple hatched histograms include
      all other types of tracks.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/ncselection_dirt_bacgkround_q2.pdf}
      \caption{Remaining background dirt events after NC elastic proton event
        selection as a function of $Q^2$.}
      \label{fig:selecteddirt}
    \end{figure}

    The dirt background is difficult to simulated for several reasons. First,
    the neutrino interactions occur outside of the detector in the surrounding
    infrastructure which is much more difficult to model perfectly than
    uniformly dense liquid argon. The composition and density distribution of
    the dirt outside of the detector hall is not known perfectly and changes
    with throughout the year due to rain, freezing, and other weather. The
    neutrino interactions can also occur in the walls of the detector building,
    the electronics racks, the cryogenic plumbing, or anything else that exists
    near the detector.
    
    Additionally, the dirt sample is difficult to simulate because it depends
    on modeling cosmic neutron flux, which is not well known at the energies
    that we are interested in~\cite{Bhadra:2009fw}. The different cosmic ray
    flux models that were tested in MicroBooNE studies~\cite{uBCosmicNote} vary
    by almost an order of magnitude in their predictions of the proton flux at
    proton kinetic energies below 100~MeV, shown in Fig.~\ref{fig:cosmicpflux}.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/backgrounds/cosmicproton_flux_compare.png}
      \caption{Comparison of the cosmic proton flux predictions from three
        different generator models in MicroBooNE~\cite{uBCosmicNote}.}
      \label{fig:cosmicpflux}
    \end{figure}

    Because of the difficulty on modeling the dirt background, we perform a
    data-driven normalization of the dirt sample. A similar scaling was
    performed in the MiniBooNE neutral current elastic cross section
    measurement~\cite{Aguilar-Arevalo:2010cx} using different observable
    variables. In MicroBooNE, the contribution from dirt events can be seen
    most clearly in the $z$ distribution of reconstructed flashes since most of
    the dirt interactions that produce a signal in the detector occur upstream
    as shown in Figure~\ref{fig:dirtneutronpos}. Figure~\ref{fig:dirtnzy} shows
    the view from the side of the detector hall with the neutrino beam going
    from left to right. The inner box shows the dimension of the MicroBooNE TPC
    and the outer box shows the dimension of the outer walls of the building.
    Figure~\ref{fig:dirtnzx} shows the top view of the detector with the beam
    again going from left to right. The inner box shows the dimension of the
    MicroBooNE TPC and the outer circle shows the dimensions of the outer wall
    of the building.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/backgrounds/allneutrons_dirt_zy.pdf}
        \caption{Position in the $z-y$ plane (looking at the side of the detector hall).}
        \label{fig:dirtnzy}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/backgrounds/allneutrons_dirt_zx.pdf}
        \caption{Position in the $z-x$ plane (looking down at the detector hall).}
        \label{fig:dirtnzx}
      \end{subfigure}
      \caption{Position of simulated neutrino interactions which produce a
      neutron that enters and interacts in the MicroBooNE TPC.}
      \label{fig:dirtneutronpos}
    \end{figure}
    Figure~\ref{fig:flashnodirt} shows a comparison of this distribution
    between the 5e19 POT subset of neutrino-beam data and the expectation from
    neutrino simulation and off-beam data \textit{without} the contribution
    from dirt interactions. There is a clear excess in neutrino beam data
    events in the upstream end of the detector ($z < 300$~cm).
    Figure~\ref{fig:flashsubtract} shows the difference between the two
    distribution in Fig.~\ref{fig:flashnodirt}, and Fig~\ref{fig:flashdirt}
    shows the $z$ distribution of reconstructed flashes from simulated dirt
    events. The shapes are similar, but the scale is not. We use these two
    distributions to extract an overall normalization factor for the dirt
    simulation.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/flashz_allevents_nodirt.pdf}
      \caption{Comparison between neutrino beam data and the expectation from
      simulation and off-beam data of the $z$ distribution of reconstructed
      flashes \textit{without} the contribution from neutrino interactions in
      the dirt.}
      \label{fig:flashnodirt}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/backgrounds/flashz_allevents_nodirt-difference.pdf}
        \caption{Difference between neutrino beam data and the expectation from
        simulation and off-beam data \textit{without} the contribution from
        neutrino interactions in the dirt.}
        \label{fig:flashsubtract}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/backgrounds/flashz_allevents_onlydirt.pdf}
        \caption{Distribution from dirt simulation.}
        \label{fig:flashdirt}
      \end{subfigure}
      \caption{Distribution of the $z$ position of reconstructed flashes in
      MicroBooNE.}
    \end{figure}
    
    The normalization factor is determined by performing a weight-least-squares
    regression on the $z$ distribution of the reconstructed flashes. The value
    that we minimized is
    \begin{equation*}
      WLS = \sum_{i=0}^{N_{bins}} w_i r_i^2 /,,
    \end{equation*}
    where the sum is over the bins in the flash position distribution, $w_i$ is
    the variance of the excess of measured events over the expectation in bin
    $i$, and
    \begin{equation*}
      r_i = x_i^{(\textrm{data exc.})} - a\cdot y_i^{(\textrm{dirt})} \,.
    \end{equation*}
    Here $x_i$ is the number of the data excess events in bin $i$, $y_i$ is the
    number of simulated dirt events in bin $i$, and $a$ is the dirt
    normalization factor that we are trying to determine. Using the Python
    SciPy~\cite{SciPy} Optimize library, we found that $WLS$ is minimized at $a
    = 0.5$. The estimated uncertainty on this normalization factor is 50\%,
    which covers the statistical variations in the first peak in the $z$ flash
    distribution. Figure~\ref{fig:flashwithdirt} shows the distribution of the
    $z$ position of the reconstructed flashes in the neutrino beam data
    compared to the expectation from the neutrino simulation and off-beam data
    including the normalized simulated dirt events. The brown bars show the
    50\% uncertainty on the dirt normalization factor.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/flashz_allevents_withunc.pdf}
      \caption{Comparison between neutrino beam data and the expectation from
      simulation and off-beam data of the $z$ distribution of reconstructed
      flashes \textit{with} the contribution from neutrino interactions in
      the dirt.}
      \label{fig:flashwithdirt}
    \end{figure}

    With the normalization, the total number of background dirt events
    remaining after the NC elastic proton events selection is
    \begin{equation*}
     N_{\textrm{dirt}} = 9.5 \pm 1.4(stat.) \pm 4.8 (syst.) \,. 
    \end{equation*}
    The normalized distribution of remaining events is the one shown in
    Fig.~\ref{fig:selecteddirt}. The effect on the overall systematic
    uncertainty on the NC elastic proton selection due to the uncertainty on
    the number of dirt events is shown in Sec.~\ref{sec:modeluncertainty}.

  \subsubsection{Beam Induced TPC and Cryostat Background}\label{sec:tpcbackgrounds}
    The beam induced TPC and cryostat background includes all background events
    in which there was a neutrino beam interaction inside the liquid argon
    cryostat. This background can be separated into cryostat background events,
    charged current TPC background events, and neutral current TPC background
    events.
    
    Like the dirt background, the neutrino interactions in the cryostat
    background occur outside of the active TPC volume, but they do occur inside
    the liquid argon cryostat, making them easier to simulate for the reasons
    described in Sec.~\ref{sec:dirt}. Like the other two background categories
    in this section, the cryostat background is included in the simulated
    neutrino data set with an overlaid cosmic data background.
    Figure~\ref{fig:selectedcryo} shows the remaining cryostat background
    events in the final NC elastic event selection as a function of
    reconstructed $Q^2$. The green filled histogram includes all remaining
    cryostat background events, and the pale green box represents the
    statistical uncertainty on the number of events. The hatched histograms
    overlaying the green filled histogram show what type of particle was
    selected as the NC elastic proton candidate. The purple diagonally hatched
    histogram includes events in which an overlaid cosmic track was selected,
    the blue hatched histogram includes events in which a neutrino-induced
    proton was selected, the red hatched histogram includes events in which a
    track from a neutrino-induced electromagnetic shower was selected, and the
    purple vertically hatched histogram includes events in which any other
    neutrino-induced track was selected. Again, the majority of the tracks
    selected as the proton candidate were actual protons. Cosmic tracks are the
    next most common track selected as the proton candidate in these events.
    Since real cosmic data is used as the background, we don't know how many of
    the selected cosmic tracks were actual protons. The other background tracks
    are negligible.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/ncselection_cryo_bacgkround_q2.pdf}
      \caption{Remaining background cryostat events after NC elastic proton
      event selection as a function of $Q^2$.}
      \label{fig:selectedcryo}
    \end{figure}

    The CC TPC background includes all events in which a charged current
    neutrino interaction occurred in the active TPC volume.
    Figure~\ref{fig:selectedcctpc} shows the remaining CC TPC background after
    the NC elastic proton selection as a function of reconstructed $Q^2$. The
    blue filled histogram includes all remaining CC TPC events, and the pale
    blue box represents the statistical uncertainty on the number of events.
    The type of particle selected as the proton candidate is shown in the
    overlaid hatched histograms with the same color and hatching scheme as in
    Fig.~\ref{fig:selectedcryo}. A large majority of the tracks selected as the
    proton candidate are actual neutrino-induced protons. These background
    proton tracks can be from charged current interaction in which a neutron is
    ejected from the nucleus during the initial interaction which later
    scatters a proton some distance from the interaction vertex. If the muon
    from the charged current interaction is not correctly identified as a
    neutrino-induced muon by the gradient-boosted decision tree classifier the
    proton can be tagged as NC elastic. The proton tracks could also be primary
    particles form a charged current interaction, but the muon from the
    interaction is either not reconstructed or reconstructed poorly enough that
    it is not associated with the same vertex as the proton and also not
    identified correctly by the decision tree classifier. The next most common
    tracks selected as the proton candidate are cosmic overlay tracks. Again,
    we don't know how many of these tracks are actual protons. In these events,
    the charged current interaction was either not reconstructed or poorly
    reconstructed, and a nearby unrelated cosmic track was selected.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/ncselection_cct_bacgkround_q2.pdf}
      \caption{Remaining CC TPC events background after NC elastic proton event
      selection as a function of $Q^2$.}
      \label{fig:selectedcctpc}
    \end{figure}

    The NC TPC background includes all events in which a neutral current
    neutrino interaction occurred in the active TPC volume, but the interaction
    was not a neutral current elastic neutrino-proton interaction.
    Figure~\ref{fig:selectednctpc} shows the remaining NC TPC background after
    the NC elastic proton selection as a function of reconstructed $Q^2$. The
    purple filled histogram includes all remaining NC TPC background events,
    and the pale purple box represents the systematic uncertainty on the number
    of events. The overlaid hatched histograms show which type of track was
    selected as the proton candidate.  In the NC TPC background events the
    selected track was almost always a neutrino-induced proton track.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/ncselection_nct_bacgkround_q2.pdf}
      \caption{Remaining NC TPC background events after NC elastic
      proton event selection as a function of $Q^2$.}
      \label{fig:selectednctpc}
    \end{figure}
    
    The NC TPC background includes NC elastic neutrino-neutron interactions, NC
    elastic interactions with a correlated neutron-proton pair in the nucleus,
    also referred to as meson-exchange-current (MEC) interactions, and all
    other nonelastic NC neutrino interactions. The NC elastic neutrino-neutron
    and NC MEC interactions are the largest NC TPC backgrounds as shown in
    Fig.~\ref{fig:ncnmecbgs}. The darkest purple histogram includes all NC
    elastic neutrino-neutron selected events, the medium purple histograms
    includes all NC MEC selected events, and the pale purple includes all other
    background events. The NC elastic neutrino-neutron cross section is a
    difficult background because the both of the final state particles in the
    initial interaction, the neutrino and the neutron, and neutral making them
    difficult to detect in the TPC. The neutron can then scatter a single
    proton in the liquid argon. These neutrino-neutron NC elastic events also
    depends on the strange axial form factor, but in the opposite way as the NC
    elastic neutrino-proton cross section. If there were exactly as many
    neutrino-neutron as neutron-proton NC elastic events selected, the
    sensitivity to $G_A^s$ would disappear. 
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/ncselection_ncn_ncmec_bacgkround_q2.pdf}
      \caption{Remaining background NC TPC background events broken down by
      interaction type after NC elastic proton event selection as a function of
      $Q^2$.}
      \label{fig:ncnmecbgs}
    \end{figure}
    The NC MEC events are difficult to distinguish from a signal event because
    the final state particles are usually a neutrino, a neutron, and a proton,
    with the proton being the only easily detectable particle. NC MEC events
    have not been very well studied because of very little data, and there is a
    large uncertainty and variation between nuclear MEC models even in the
    charged current sector where there is more experimental data. In the
    version of the GENIE Monte Carlo neutrino generator that was used for this
    analysis, only one model for NC MEC events is available referred to as the
    ``empirical MEC model". However, for CC MEC interactions there are two
    models available: the empirical model and the Nieves
    model~\cite{Nieves:2011pp,Nieves:2011yp}. We can look at the difference
    between the two CC MEC models in MicroBooNE simulation to estimate the
    correct scale and uncertainty on the number of NC MEC events.
    Figure~\ref{fig:ccmec} shows the number of CC MEC events in the MicroBooNE
    simulation as a function of true $Q^2$ for each of the two models scaled to
    5e19 POT. The two models were also simulated with different nuclear and FSI
    models, which have a much smaller effect on the number of events than the
    MEC model.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/CCMEC_compare.pdf}
      \caption{Comparison of the number of CC MEC events in MicroBooNE
      simulation between the two models as a function of true $Q^2$.}
      \label{fig:ccmec}
    \end{figure}

    To cover the difference in the MEC models in this analysis, we multiply all
    MEC events by a correction factor so that the total number is the average
    of the two models, and apply an uncertainty so that the prediction of
    either model is one standard deviation from the scaled number of events.
    This is shown in Fig.~\ref{fig:ccmecscale} with the simulated events for
    the two models the same as in Fig~\ref{fig:ccmec} and the black points
    showing the scaled events with one standard deviation systematic
    uncertainty bars. All MEC events above $Q^2 = 0.5$~GeV$^2$ are given a
    correction factor of one. The MEC correction factor and uncertainty is
    applied to both NC and CC MEC events. The effect on the overall systematic
    uncertainty of the NC elastic proton selection due to the MEC uncertainty
    is shown in Sec.~\ref{sec:modeluncertainty}.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/CCMEC_compare_withnew.pdf}
      \caption{Corrected number of CC MEC events as a function of true $Q^2$ with
      one standard deviation systematic uncertainty bars.}
      \label{fig:ccmecscale}
    \end{figure}

  \subsubsection{Cosmic Background}
    The cosmic background comes from both cosmic interactions that occur within
    the 1.6~$\mu s$ neutrino beam spill window triggering the event readout and
    from cosmic interactions that occur within the 1.6~$ms$ TPC readout window
    that was triggered by a neutrino beam interaction. The latter is included
    in the previous sections because they cosmic tracks are part of the
    neutrino triggered events. The rate of cosmic interactions that trigger the
    readout, referred to as in-time cosmic interactions, are determined from
    the off-beam data stream. The exact same trigger logic is run in the
    on-beam and off-beam data streams, but with the off-beam trigger being
    offset in time from the neutrino beam spill. This allows us the determine
    the cosmic in-time background almost exactly.  Figure~\ref{fig:selectedext}
    shows the remaining off-beam events after the NC elastic proton selected
    after scaling to the correct number of triggers in the on-beam data set as
    shown in Sec.~\ref{sec:datamcevent}. The pale gray box represents the
    statistical uncertainty on the number of events.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/backgrounds/ncselection_ext_bacgkround_q2.pdf}
      \caption{Remaining in-time cosmic background events after NC elastic
      proton event selection as a function of $Q^2$.}
      \label{fig:selectedext}
    \end{figure}
  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Systematic Uncertainty Estimation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Estimation of Systematic Uncertainty}\label{sec:systematics}
  The estimation of the systematic uncertainty due to the neutrino beam flux,
  the detector physics modeling, and the nuclear and cross section physics
  models are described in this section. Since the measured neutrino beam data
  that passes the selection is compared directly to the expectation from
  simulation and off-beam data, the systematic uncertainty is estimated for and
  applied to the simulation only, and the data is unaltered.
  \subsubsection{Neutrino Beam Flux Uncertainty}\label{sec:fluxuncertainty}
    The systematic uncertainties on the neutrino beam flux prediction at
    MicroBooNE have evaluated in detail in Ref.~\cite{uBFluxNote}.
    Figure~\ref{fig:ubflux} shows the calculated neutrino flux with the
    associated uncertainty. The region with the largest uncertainty is below
    the peak of the elastic neutrino cross section. Figure~\ref{fig:fluxq2}
    shows the uncertainty on the number of simulated neutrino interactions in
    5e19 POT of MicroBooNE data due to the flux uncertainty as a function of
    true neutrino energy. Figure~\ref{fig:fluxenuall} includes all simulated
    neutrino interactions and Fig.~\ref{fig:fluxenunce} only includes simulated
    NC elastic neutrino-proton interactions.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/systematics/flux_true_wunc.pdf}
      \caption{Neutrino flux prediction with systematic uncertainty at
      MicroBooNE~\cite{uBFluxNote}.}
      \label{fig:ubflux}
    \end{figure}
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/flux_evts_enu.pdf}
        \caption{All simulated neutrino interactions.}
        \label{fig:fluxenuall}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/flux_evts_nce_enu.pdf}
        \caption{Simulated NC elastic neutrino-proton interactions.}
        \label{fig:fluxenunce}
      \end{subfigure}
      \caption{The uncertainty on the number of simulated events due to the
      neutrino beam flux uncertainty as a function of $E_{\nu}$.}
      \label{fig:fluxq2}
    \end{figure}

    Since we are interested in a specific range of negative four-momentum
    transfer squared, it is useful to know the effect of the neutrino flux
    uncertainty as a function of $Q^2$. Figure~\ref{fig:qevenu} shows the
    relationship between the true four-momentum transfer squared and the true
    neutrino energy in simulated NC elastic neutrino-proton interactions in
    MicroBooNE. The color scale represents the number of events in arbitrary
    units with yellow being the highest and dark blue being the lowest. The
    dashed white lines represent the $Q^2$ range of interest in this analysis.
    The interactions with the lowest neutrino energy and the highest fractional
    uncertainty have a four-momentum transfer squared below the range of
    interest. Figure~\ref{fig:q2frac} shows the fractional uncertainty on the
    number of simulated NC elastic neutrino-proton interactions due to the
    neutrino flux uncertainty as a function of true $Q^2$. The dashed blue line
    represents the lower end of the $Q^2$ interest range.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/flux_enuq2_hist2d.pdf}
      \caption{The relationship between true $Q^2$ and true $E_{\nu}$ in
      simulated NC elastic neutrino-proton interactions in MicroBooNE.}
      \label{fig:qevenu}
    \end{figure}
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/flux_evts_nce_q2_frunc.pdf}
      \caption{Fractional uncertainty on the number of simulated NC elastic
      neutrino-proton interactions due to the beam flux uncertainty as a
      function of $Q^2$.}
      \label{fig:q2frac}
    \end{figure}
    Figure~\ref{fig:fluxq2} shows the uncertainty on the number of simulated
    neutrino interactions in 5e19 POT of MicroBooNE data due to the flux
    uncertainty as a function of true neutrino energy.
    Figure~\ref{fig:fluxq2all} includes all simulated neutrino interactions and
    Fig.~\ref{fig:fluxq2nce} only includes simulated NC elastic neutrino-proton
    interactions.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/flux_evts_enu.pdf}
        \caption{All simulated neutrino interactions.}
        \label{fig:fluxq2all}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/flux_evts_nce_enu.pdf}
        \caption{Simulated NC elastic neutrino-proton interactions.}
        \label{fig:fluxq2nce}
      \end{subfigure}
      \caption{The uncertainty on the number of simulated events due to the
      neutrino beam flux uncertainty as a function of $E_{\nu}$.}
      \label{fig:fluxq2}
    \end{figure}

    Figure~\ref{fig:systflux} shows the NC elastic proton selection on
    simulation and off-beam data with the statistical and systematic
    uncertainty due to the uncertainty on the neutrino beam flux as a function
    of reconstructed $Q^2$. In this figure, and all of the similar figures in
    this section, the color filled histograms include simulated neutrino data
    with true NC elastic proton events in peach and the gray filled histogram
    includes off-beam data events all scaled to the expected Run I 1.7e20 POT
    of data.  The inner error bar represents the statistical uncertainty on the
    number of events, and the outer error bar represents the combined
    statistical and systematic uncertainty due to the flux uncertainty.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_fluxsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to the uncertainty on the
      neutrino beam flux.}
      \label{fig:systflux}
    \end{figure}


  \subsubsection{Detector Physics Uncertainty}\label{sec:detvar}
    The uncertainty on the expected number of events due to mis-modeling of the
    detector physics in the simulation is estimated by generating simulated
    events with variations in the detector physics parameters. First, a set of
    events are generated, propagated through the detector geometry, and
    reconstructed all with the default MicroBooNE simulation parameters. Then,
    the same generated events are propagated through the detector geometry with
    a given parameter varied by one standard deviation of the estimated
    uncertainty on the parameter. This is done for all detector physics
    parameters that are expected to have a large effect on the final event
    selection. The events simulated with the default parameters can be directly
    compared to the events simulated with the varied parameters to determine
    the effect. 
    
    The detector physics effects that are expected to have the largest effect
    on the NC elastic proton selection in simulation are the dynamic induced
    charge on the wires, the space charge effect, and the single PE background
    rate. Full MicroBooNE simulation samples were generated to test each of
    these three effects. 

    In the default MicroBooNE simulation, charge induction is only simulated on
    the wire closest to the drifting charge on each of the wire planes.  An
    estimated induced charged is added to the ten closest wires to the drifting
    charge in a detector variation sample. The estimation is not a full 2D
    simulation of effect of the drifting charge on the wires, which will be
    added to later version of MicroBooNE simulations. Figure~\ref{fig:dicevd}
    shows event displays of a simulated proton on the second induction plane
    event using the default settings without the dynamic induced charge
    estimation, Fig~\ref{fig:dicevdcv}, and with the dynamic induced charge
    estimation in the alternative sample, Fig.~\ref{fig:dicevddic}. At the
    bottom of both events display, an individual wire signal is shown from one
    wire in the middle of the track.  The track was selected as an NC elastic
    proton in the default simulation, but not in the alternative simulation.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/p2_CV_crop.png} \\
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/p2_CV_crop_wire.png}
        \caption{Using the default detector physics parameters.}
        \label{fig:dicevdcv}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/p2_DIC_crop.png} \\
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/p2_DIC_crop_wire.png}
        \caption{With the estimated dynamic induced charge on the wires.}
        \label{fig:dicevddic}
      \end{subfigure}
      \caption{Comparison of an event display of the second induction plane
      using the default detector physics parameters and using the estimated
      dynamic induced charge on the
      wires.}
      \label{fig:dicevd}
    \end{figure}

    Figure~\ref{fig:dicchange} shows the total number of selected events as a
    function of reconstructed $Q^2$ in the default detector physics sample and
    the dynamic induced charge estimation sample. The effect is much larger in
    the first bin (a 40\% change) than the higher $Q^2$ bins (a 25\% change).
    Figure~\ref{fig:dicchangeall} includes all simulated events passing the NC
    elastic proton selection, and Fig.~\ref{fig:dicchangence} only includes
    simulated true NC elastic proton events passing the NC elastic proton
    selection. The percent change as a function of $Q^2$ bin is similar between
    the two. To account for the difference due to not having a full dynamic
    induced charge simulation, a 40\% uncertainty in the negative direction is
    added to the first reconstructed $Q^2$ bin, and 25\% uncertainty in the
    negative direction to each of the higher reconstructed $Q^2$ bins. No
    uncertainty in the positive direction is attributed to the dynamic induced
    charge model because the default simulation includes no model at all, and
    adding induced charge isn't expected to increase the number of events
    selected.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/ncselection_syst_DIC.pdf}
        \caption{Including all simulated events.}
        \label{fig:dicchangeall}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/ncselection_syst_DIC_nce.pdf}
        \caption{Only NC elastic proton events.}
        \label{fig:dicchangence}
      \end{subfigure}
      \caption{Change in the number of simulated events passing the NC elastic
      proton selection as a function of reconstructed $Q^2$ between the default
      detector physics and with the estimated dynamic induced charge on the
      wires.}
      \label{fig:dicchange}
    \end{figure}
    
    Figure~\ref{fig:systdic} shows the NC elastic proton selection on
    simulation and off-beam data with the statistical and systematic
    uncertainty due to the dynamic induced charge on the wires as a function of
    reconstructed $Q^2$. The inner error bar represents the statistical
    uncertainty on the number of selected events and the outer error bar
    represents the combined statistic and systematic uncertainty due to the
    induced charge.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_dicsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to the dynamic induced
      charge on the wires.}
      \label{fig:systdic}
    \end{figure}

    The space charge effect is due to the build up of positive ions in areas of
    the detector that lead to a distortion of the electric field. The effect in
    MicroBooNE is described in detail in Ref.~\cite{uBSCENote}. In the detector
    physics variation sample, a data-driven correction is applied to the
    electric field distortion, which will be included in future MicroBooNE
    simulations.  Figure~\ref{fig:scechange} shows the change in the number of
    simulated events passing the NC elastic proton selection as a function of
    reconstructed $Q^2$ between the default detector physics sample and the
    space charge correction sample. Figure~\ref{fig:scechangeall} includes all
    passing simulated events, and Fig.~\ref{fig:scechangence} only includes
    true NC elastic proton events. The change in the number of selected events
    between the two samples is small.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/ncselection_syst_SCE.pdf}
        \caption{Including all simulated events.}
        \label{fig:scechangeall}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/ncselection_syst_SCE_nce.pdf}
        \caption{Only NC elastic proton events.}
        \label{fig:scechangence}
      \end{subfigure}
      \caption{Change in the number of simulated events passing the NC elastic
      proton selection as a function of reconstructed $Q^2$ between the default
      detector physics and with the space charge correction.}
      \label{fig:scechange}
    \end{figure}

    To test the effect of the rate of the single photoelectron background in
    the PMTs, a simulation sample was generated which varies the single PE rate
    by $\pm 20\%$. The flash produced by short single proton tracks can be
    small and near the PE threshold for optical pre-selection. Additionally,
    the NC elastic proton selection is dependent on the reconstructed position
    of the beam flash which can be affected by the background PEs in the PMTs,
    especially for smaller flashes. This is because the reconstructed position
    of the flash is weighted by the number of PEs in each PMT, and the single
    PE background is uniform in MicroBooNE. Figure~\ref{fig:spechange} shows the
    change in the number of simulated events passing the NC elastic proton
    selection as a function of reconstructed $Q^2$ when the single PE
    background rate is varied by $\pm 20\%$. Figure~\ref{fig:spechangeall}
    includes all passing simulated events, and Fig.~\ref{fig:spechangence} only
    includes true NC elastic proton events. The small reduction in the number
    of selected events when the single PE rate is decreased by 20\% (dashed
    line) is mainly due to events with flashes near the PE threshold being cut
    in the optical pre-selection. The large reduction when the single PE rate
    is increased by 20\% is mainly due to the distance between the center of
    the reconstructed flash and track increasing. 
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/ncselection_syst_PE.pdf}
        \caption{Including all simulated events.}
        \label{fig:spechangeall}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/ncselection_syst_PE_nce.pdf}
        \caption{Only NC elastic proton events.}
        \label{fig:spechangence}
      \end{subfigure}
      \caption{Change in the number of simulated events passing the NC elastic
      proton selection as a function of reconstructed $Q^2$ when the single PE
      background rate is varied.}
      \label{fig:spechange}
    \end{figure}
    Even though increasing and decreasing the single PE rate by 20\% both have
    a negative effect on the number of events, it is due to different effects,
    and a smaller variation could increase the number of selected events. To
    account for this we apply a symmetric uncertainty of 20\% which is the
    percent change in the number of selected events when the single PE rate was
    increased. Figure~\ref{fig:systspe} shows the NC elastic proton selection
    on simulation and off-beam data with the statistical and systematic
    uncertainty due to the single PE background rate as a function of
    reconstructed $Q^2$. The inner error bar represents the statistical
    uncertainty on the number of selected events and the outer error bar
    represents the combined statistic and systematic uncertainty due to the
    single PE rate.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_spesyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to the single PE
      background rate.}
      \label{fig:systspe}
    \end{figure}

  \subsubsection{Model Uncertainty}\label{sec:modeluncertainty}
    There is systematic uncertainty on the number of events in the NC elastic
    proton selection due to the nuclear models and the neutrino-nucleon cross
    section models. The uncertainty on the cross section model is due to the
    uncertainty on the electromagnetic and charged current axial form factors
    used in the model. The uncertainty on the nuclear models is much larger and
    comes from several different effects.

    The estimated of the uncertainty due to the MEC model was discussed in
    Sec.~\ref{sec:tpcbackgrounds}. The effect of this uncertainty on the NC
    elastic proton selection is shown in Fig.~\ref{fig:systmec} as a function
    of $Q^2$. The color filled histograms include the simulated neutrino events
    with NC elastic neutrino-proton events in peach, and the gray filled
    histogram includes the off-beam data all scaled to the expected selection
    in the 1.7e20 POT Run I data. The inner error bars represent the
    statistical uncertainty on the number of events, and the outer error bar
    represents the combined statistical and systematic uncertainty due to the
    estimated uncertainty on the MEC model. Although the uncertainty on the MEC
    model is large, as shown in Fig.~\ref{fig:ccmecscale}, the number of
    selected MEC events is small enough that the effect on the overall
    selection uncertainty is small.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_mecsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to the uncertainty on the
      MEC model.}
      \label{fig:systmec}
    \end{figure}

    The GENIE version used in this analysis implements a relativistic Fermi gas
    (RFG) nuclear momentum model~\cite{Bodek:1981wr}. The model assumes that the
    nucleons in the target nucleus have a uniform momentum distribution up to
    the Fermi momentum $k_F$. Neutrino-nucleon interactions are only allowed if
    the outgoing nucleon momentum is greater than $k_F$. This effect is
    referred to as Pauli blocking (or Pauli suppression). The Fermi momentum in
    argon is assumed to be $k_F = 0.0295$. In the GENIE Reweighting tool, the
    uncertainty in the amount of Pauli blocking is accounted for by varying the
    Fermi momentum by $\pm 35\%$~\cite{Andreopoulos:2015wxa}. However, this is
    only implemented in the GENIE Reweighting tool for charged current
    quasi-elastic (CCQE) interactions. Since Pauli blocking is a nuclear
    effect, we assume that the uncertainty due Pauli blocking as a function of
    true $Q^2$ is the same for NC elastic and CCQE interactionss in argon and
    apply the uncertainty found for CCQE interactions to NC elastic
    interactions, as well.  Figure~\ref{fig:pauliblock} shows the uncertainty
    due to Pauli blocking on CCQE interactions as a function of true $Q^2$ for
    an arbitrary number of simulated interactions. The solid line shows the
    number of simulated CCQE interactions using the default value of $k_F =
    0.0295$, the upper dashed line shows the number of simulated CCQE
    interactions using $k_F = 0.0295(1 - 0.35)$, and the lower dashed line
    shows the number of simulated CCQE interactions using $k_F = 0.0295(1 +
    0.35)$ (higher value of $k_F$ corresponds to greater suppression). The
    effect is largest at true $Q^2$ values less than 0.1~GeV$^2$.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/FermiGasModelKf_Genie.pdf}
      \caption{The systematic uncertainty due to Pauli blocking on simulated
      CCQE events as a function of true $Q^2$ using the GENIE Reweighting
      tool.}
      \label{fig:pauliblock}
    \end{figure}

    Figure~\ref{fig:systpauli} shows the effect on the NC elastic proton events
    selection as a function of reconstructed $Q^2$ due to applying the Pauli
    blocking uncertainty to NC elastic and CCQE events. The inner error bar
    represents the statistical uncertainty on the number of events, and the
    outer error bar represents the systematic uncertainty due to Pauli
    blocking.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_kfsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to Pauli blocking.}
      \label{fig:systpauli}
    \end{figure}

    The GENIE Reweighting package also includes tools to determine the
    uncertainty on the simulation due to the probability of the nucleon
    re-interacting in the nucleus. This is done for by varying the mean free
    path of the nucleon, $N_{mfp}$, in the argon nucleus which is proportional
    to the total rescattering probability. Figure~\ref{fig:systnmfp} shows the
    systematic uncertainty on the number of events due to varying $N_{mpf}$ by
    $\pm 20\%$ for all events using the GENIE Reweighting tool. The inner error
    bars represent the statistical uncertainty on the number of selected
    events, and the outer error bars represent the combined statistical and
    systematic uncertainty due to the FSI probability. 
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_nmfpsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to the nucleon
      rescattering probability in the argon nucleus.}
      \label{fig:systnmfp}
    \end{figure}

    To determine the uncertainty due to the choice of the nuclear model itself,
    simulation samples were generated with alternative nuclear momentum and FSI
    models. The nuclear momentum model is changed from the default RFG model to
    a local Fermi gas (LFG) model~\cite{Leitner:2008ue}. The FSI model changed
    from the hA GENIE model to the hA2014 GENIE model~\cite{Alam:2015nkk}. The
    NC elastic neutrino-nucleon cross section is unchanged in the alternative
    simulation sample, so the effect of changing the Fermi gas and FSI models
    was tested in NC elastic interactions. Figure~\ref{fig:ncfg} shows the
    change in the number of simulated NC elastic events in 5e19 POT of data for
    the two different simulation sets as a function of reconstructed $Q^2$. The
    blue lines show the events simulated with the RFG nuclear momentum model
    and the hA FSI model, and the orange lines show the events simulated with
    the LFG nuclear momentum model and the hA2014 FSI model. The corresponding
    colored boxes show the statistical uncertainty on the number of events.
    Figure~\ref{fig:ncfgp} only includes the NC elastic \textit{proton} events,
    and Fig.~\ref{fig:ncfgn} includes the NC elastic \textit{neutron} events. For
    both interaction types, the change in the number of events between models
    is within statistical uncertainty. The overall change in the number of
    events in the NC elastic proton selection is about 1\%.
    \begin{figure}[h]
      \centering
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/NCEp_syst_compare.pdf}
        \caption{NC elastic neutrino-proton events.}
        \label{fig:ncfgp}
      \end{subfigure}
      \hspace{2pt}
      \begin{subfigure}[t]{2.8in}
        \includegraphics[angle=0,width=2.8in]{figures/analysis/systematics/NCEn_syst_compare.pdf}
        \caption{NC elastic neturino-neutron events.}
        \label{fig:ncfgn}
      \end{subfigure}
      \caption{The change in the number of NC elastic events with different
      nuclear momentum and FSI models as a function of reconstructed $Q^2$.}
      \label{fig:ncfg}
    \end{figure}

    The estimation of the uncertainty on the number of dirt interactions in
    MicroBooNE was described in Sec.~\ref{sec:dirt}. Figure~\ref{fig:systdirt}
    shows the systematic uncertainty on the NC elastic proton selection due to
    the dirt uncertainty. The inner error bars represent the statistical
    uncertainty on the number of events, and the outer error bars represent the
    combined statistical and systematic uncertainty due to the number of dirt
    events.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4in]{figures/analysis/systematics/ncselection_dirtsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty due to the number of dirt
      interactions.}
      \label{fig:systdirt}
    \end{figure}

    The uncertainty on the NC elastic proton selection due to the electric,
    magnetic, and charged current axial form factor z expansion models was
    found to be small. The uncertainty on the models were taken directly from
    the Refs.~\cite{Ye:2017gyb,Meyer:2016oeg} and extrapolated to the NC elastic
    proton selection. The total uncertainty on the selection due to the form
    factor models was found to be $0.5\%$.

    Table~\ref{tab:systuncertainties} shows the contribution from each of the
    systematic effects to the overall uncertainty on the number of expected
    events in the NC elastic proton selection. If an asymmetric systematic
    uncertainty is applied, the larger of the two is shown in the table.
    \begin{table}[ht]
      \caption{Contributions to the systematic uncertainty on the number of
      simulated events passing the NC elastic proton selection.
      \label{tab:systuncertainties}}
      \centering
      \begin{tabularx}{9cm}{ l r }
        \hline
        Source & Uncertainty \% \\
        \hline
        Neutrino Beam Flux & 9.8 \\
        \hline
        Dynamic Induced Charged & 27.5 \\
        Space Charge & 5.0 \\
        Single PE Rate & 20.0 \\
        \hline
        MEC Model & 5.9 \\
        Pauli Blocking & 4.9 \\
        Fermi Gas and FSI Models & 1.0 \\
        FSI Interaction Probability & 5.5 \\
        \hline
        Dirt Events & 3.2 \\
        \hline
        Form Factor Model & 1.7 \\
        \hline
      \end{tabularx}
    \end{table}

    Figure~\ref{fig:systall} shows the total combined systematic uncertainty on
    the NC elastic proton selection from all of the effects desribed in this
    section. The inner error bars represent the statistical uncertainty on the
    number of events, and the outer error bars represent the combined
    statistical and systematic uncertainty.
    \begin{figure}[ht]
      \centering
      \includegraphics[angle=0,width=4.5in]{figures/analysis/systematics/ncselection_totalsyst_q2.pdf}
      \caption{The NC elastic proton selection on simulation and off-beam data
      with statistical and systematic uncertainty.}
      \label{fig:systall}
    \end{figure}

